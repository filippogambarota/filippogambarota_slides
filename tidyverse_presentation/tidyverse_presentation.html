<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>A (space) travel into the Tidyverse ðŸš€</title>
    <meta charset="utf-8" />
    <meta name="author" content="Filippo Gambarota" />
    <meta name="date" content="2020-10-11" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# A (space) travel into the Tidyverse ðŸš€
### Filippo Gambarota
### University of Padova - Psicostat
### 10/11/2020

---




# Contents

* ### What is the **tidyverse** and the **tidy approach**

* ### The main packages and function

* ### Other **tidy** packages

* ### Some examples

---
class: inverse, middle, center

# What is the Tidyverse?

---

# Tidyverse

.pull-left[
&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="img/hadley-wickham.jpg" alt="Hadley Wickham - RStudio Data Scientist"  /&gt;
&lt;p class="caption"&gt;Hadley Wickham - RStudio Data Scientist&lt;/p&gt;
&lt;/div&gt;

]
.pull-right[
* The tidyverse is an opinionated collection of R packages designed for data science. All packages **share an underlying design philosophy, grammar, and data structures**

&lt;img src="img/tidyverse.svg" height="300" style="display: block; margin: auto;" /&gt;

]

---

# The big picture

&lt;img src="img/big_picture.png" style="display: block; margin: auto;" /&gt;

---

class: inverse, middle, center

# What is the Tidy approach?

---

# What is the tidy approach?

* ## The best way to format data is the **long format**

&lt;br&gt;

* ## Concatenate operations with **pipes**

&lt;br&gt;

* ## Focus on a **functional programming approach**

---

# Long-format data




* ### Each row is an **observation** and each column is a **variable**

.pull-left[


```r
head(dat)
```

```
## # A tibble: 6 x 3
##      id cond      cov
##   &lt;int&gt; &lt;chr&gt;   &lt;dbl&gt;
## 1     1 A     -0.0322
## 2     1 B     -1.19  
## 3     1 C      0.752 
## 4     2 A     -1.27  
## 5     2 B     -0.122 
## 6     2 C     -0.527
```
]

.pull-right[


```r
dat %&gt;% 
  pivot_wider(names_from = cond, values_from = cov) %&gt;% 
  head()
```

```
## # A tibble: 6 x 4
##      id       A      B      C
##   &lt;int&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;
## 1     1 -0.0322 -1.19   0.752
## 2     2 -1.27   -0.122 -0.527
## 3     3 -0.297   1.24   0.562
## 4     4  0.955   0.361 -1.28 
## 5     5 -1.33   -0.735  0.773
## 6     6  0.792   0.217  0.912
```
]

---

# Concatenate operations with **pipes**

.pull-left[
&lt;img src="img/magrittr.png" width="200" style="display: block; margin: auto;" /&gt;
]

.pull-right[

* Pipes are some operators from the `magrittr::` package with the aim of **improving the code readability and maintainability** &lt;sup&gt;1&lt;/sup&gt;

* There are several different **pipes** but the most used (and useful) is the `%&gt;%`

* Pipes are integrated with all **tidyverse** functions and packages

]

.footnote[[1] [magrittr website](https://cran.r-project.org/web/packages/magrittr/vignettes/magrittr.html)
]

---

# Concatenate operations with **pipes**

* The `%&gt;%` pipe is another way to **declare the function with an argument**

* If `.f` is a function and `.x` is an object, this `.f(x)` is equivalent to `.x %&gt;% .f`

--


```r
mean(iris$Sepal.Length)
```

```
## [1] 5.843333
```

--


```r
iris$Sepal.Length %&gt;% 
  mean()
```

```
## [1] 5.843333
```

---

# Concatenate operations with **pipes**



The previous simple example is not completely appropriate, the `pipe` is useless. However let's assume a more complicated example where:

1. aggregate data by a `factor` using the `mean()` 
2. create a new columns with some operations between columns
3. rename a variable

--


```r
head(dat)
```

```
## # A tibble: 6 x 6
##      id cond1 cond2 value    cov1   cov2
##   &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;
## 1     1 A     1     103.  -0.0191 0.0198
## 2     1 A     2      73.9 -0.0191 0.0198
## 3     1 A     3     114.  -0.0191 0.0198
## 4     1 B     1      96.9 -0.0191 0.0198
## 5     1 B     2     106.  -0.0191 0.0198
## 6     1 B     3     109.  -0.0191 0.0198
```

---
# Without pipes and tidyverse


```r
dat &lt;- aggregate(value ~ id + cond1 + cov1 + cov2, mean, data = dat) # aggregate by cond1
dat$cov1 &lt;- dat$cov1 - mean(dat$cov1) # center
dat$cov2 &lt;- (dat$cov2 - mean(dat$cov2))/sd(dat$cov2) # z point
names(dat)[1] &lt;- "subject" # rename
head(dat)
```

```
##   subject cond1      cov1      cov2     value
## 1       2     A  1.366700 -1.563120 111.39282
## 2       2     B  1.366700 -1.563120 104.73908
## 3       2     C  1.366700 -1.563120  92.73584
## 4       7     A -1.269611 -1.147661  94.16686
## 5       7     B -1.269611 -1.147661 108.36546
## 6       7     C -1.269611 -1.147661 100.22601
```

--

* This works fine but is a little bit **redundant**, **difficult to read** and there is a **series of assignment operations**

* Some columns are not in the correct order

* In order to have a new `dat`, you can create a `dat_agg` or overwrite the `dat` object

---

# With pipes and tidyverse





```r
dat %&gt;% 
  mutate(cov1 = cov1 - mean(cov1),
         cov2 = (cov2 - mean(cov2))/sd(cov2)) %&gt;% 
  rename("subject" = id) %&gt;% 
  group_by(subject, cond1, cov1, cov2) %&gt;% 
  summarise(mean = mean(value),
            sd = sd(value)) %&gt;% 
  ungroup() %&gt;% 
  head()
```

```
## `summarise()` regrouping output by 'subject', 'cond1', 'cov1' (override with `.groups` argument)
```

```
## # A tibble: 6 x 6
##   subject cond1   cov1   cov2  mean    sd
##     &lt;int&gt; &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1       1 A     -1.10  -0.405  96.4  4.88
## 2       1 B     -1.10  -0.405 101.   7.40
## 3       1 C     -1.10  -0.405 103.   6.69
## 4       2 A      0.373  0.336 101.   9.59
## 5       2 B      0.373  0.336 102.   4.24
## 6       2 C      0.373  0.336  99.3 13.6
```

---

# With pipes and tidyverse


```r
dat %&gt;% 
  mutate(cov1 = cov1 - mean(cov1),
         cov2 = (cov2 - mean(cov2))/sd(cov2)) %&gt;% 
  rename("subject" = id) %&gt;% 
  group_by(subject, cond1, cov1, cov2) %&gt;% 
  summarise(mean = mean(value),
            sd = sd(value)) %&gt;% 
  ungroup() %&gt;% 
  head()
```

* The `dat` object is not modified

* Operations follows an **easy to read workflow of operations**

* If you want to assign you can use `&lt;-` at the beginning as `dat &lt;- dat %&gt;% ...`

---

# Functional Programming

Without technical details, the idea of functional programming is the comparison between a `for loop` and a `apply family` function &lt;sup&gt;2&lt;/sup&gt;

.footnote[[2] From the Hadley Wickam talk - [Managing many models with R](https://www.youtube.com/watch?v=rz3_FDVt9eg)
]

--


```r
means &lt;- vector("double", ncol(mtcars))
medians &lt;- vector("double", ncol(mtcars))

for(i in seq_along(mtcars)) {
    means[[i]] &lt;- mean(mtcars[[i]], na.rm = TRUE)
    medians[[i]] &lt;- median(mtcars[[i]], na.rm = TRUE)
}
```

--


```r
means &lt;- lapply(mtcars, function(x) mean(x))
median &lt;- lapply(mtcars, function(x) median(x))
```

---

# Functional Programming with purrr::

.pull-left[
&lt;img src="img/purrr.svg" width="200" style="display: block; margin: auto;" /&gt;

&lt;img src="img/furrr.svg" width="200" style="display: block; margin: auto;" /&gt;
]

.pull-right[

* Purrr is as package that provides a series of **apply like** functions in order to perform complex and fast operations

* Furrr is the same package as `purrr` but with a `future` implementation in order to parallelize the operations


```r
means &lt;- map_dbl(mtcars, mean)
means[1:4]
```

```
##       mpg       cyl      disp        hp 
##  20.09062   6.18750 230.72188 146.68750
```

```r
# sapply(mtcars, function(x) mean(x))
```
]

---

class: inverse, middle, center

# Main packages and functions

---

# Main packages and functions

&lt;img src="img/big_picture_high.png" style="display: block; margin: auto;" /&gt;

---

# Tidyr

.pull-left[
&lt;img src="img/tidyr.svg" width="500" style="display: block; margin: auto;" /&gt;
]

.pull-right[

* Manipulate datasets to have **tidy** data

* Main functions are `pivot_longer()`, `pivot_wider`, and `separate()`

* Other functions like `drop_na()` and `nest()`

]

---

## Pivoting datasets

### From long to wide dataset


```r
dat %&gt;% 
  head()
```

```
## # A tibble: 6 x 6
##      id cond1 cond2 value  cov1   cov2
##   &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
## 1     1 A     1      98.3 -1.18 -0.277
## 2     1 A     2     100.  -1.18 -0.277
## 3     1 A     3      90.9 -1.18 -0.277
## 4     1 B     1     101.  -1.18 -0.277
## 5     1 B     2     108.  -1.18 -0.277
## 6     1 B     3      93.4 -1.18 -0.277
```

---

## Pivoting datasets

### From long to wide dataset


```r
dat %&gt;% 
  pivot_wider(names_from = c(cond1, cond2), values_from = value) %&gt;%
  head()
```

```
## # A tibble: 6 x 12
##      id   cov1    cov2   A_1   A_2   A_3   B_1   B_2   B_3   C_1   C_2   C_3
##   &lt;int&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     1 -1.18  -0.277   98.3 100.   90.9 101.  108.   93.4 106.   95.3 108. 
## 2     2  0.294  0.252  110.   91.0 103.  105.   97.4 105.  113.   85.4  99.7
## 3     3 -1.03   0.0898 102.   83.4 106.  104.  111.   97.1 112.   97.8  98.3
## 4     4 -0.648  1.39    92.0  88.0 104.  106.   73.4  97.4 123.   82.8 102. 
## 5     5  0.180  0.275   87.3 103.   96.3  96.3  89.9  97.9 102.  101.   96.5
## 6     6 -0.358 -0.0788 102.   94.0 111.  102.   93.5  94.2  96.3 103.  104.
```

---

### From wide to long dataset


```r
dat %&gt;% 
  pivot_wider(names_from = c(cond1, cond2), values_from = value) %&gt;% 
  pivot_longer(4:12, names_to = "cond", values_to = "value")
```

```
## # A tibble: 90 x 5
##       id   cov1   cov2 cond  value
##    &lt;int&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
##  1     1 -1.18  -0.277 A_1    98.3
##  2     1 -1.18  -0.277 A_2   100. 
##  3     1 -1.18  -0.277 A_3    90.9
##  4     1 -1.18  -0.277 B_1   101. 
##  5     1 -1.18  -0.277 B_2   108. 
##  6     1 -1.18  -0.277 B_3    93.4
##  7     1 -1.18  -0.277 C_1   106. 
##  8     1 -1.18  -0.277 C_2    95.3
##  9     1 -1.18  -0.277 C_3   108. 
## 10     2  0.294  0.252 A_1   110. 
## # ... with 80 more rows
```

---

### From wide to long dataset


```r
dat %&gt;% 
  pivot_wider(names_from = c(cond1, cond2), values_from = value) %&gt;% 
  pivot_longer(4:12, names_to = "cond", values_to = "value") %&gt;% 
  separate(cond, into = c("cond1", "cond2"), sep = "_") %&gt;% 
  head()
```

```
## # A tibble: 6 x 6
##      id  cov1   cov2 cond1 cond2 value
##   &lt;int&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;
## 1     1 -1.18 -0.277 A     1      98.3
## 2     1 -1.18 -0.277 A     2     100. 
## 3     1 -1.18 -0.277 A     3      90.9
## 4     1 -1.18 -0.277 B     1     101. 
## 5     1 -1.18 -0.277 B     2     108. 
## 6     1 -1.18 -0.277 B     3      93.4
```

---

# Dplyr

.pull-left[
&lt;img src="img/dplyr.svg" width="400" style="display: block; margin: auto;" /&gt;
]

.pull-right[

* This is a very comprehensive package with several functions to create new columns, aggregate datasets, select rows, etc.

* `mutate()` adds new variables that are functions of existing variables
* `select()` picks variables based on their names.
* `filter()` picks cases based on their values.
* `summarise()` reduces multiple values down to a single summary.
* `arrange()` changes the ordering of the rows.

]

---

# Dplyr


```r
dat %&gt;% 
  mutate(new_col = some_functions(other_col))
```


```r
dat %&gt;% 
  mutate(new_col = cov1 * cov2) %&gt;% 
  head()
```

```
## # A tibble: 6 x 7
##      id cond1 cond2 value  cov1   cov2 new_col
##   &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
## 1     1 A     1      98.3 -1.18 -0.277   0.327
## 2     1 A     2     100.  -1.18 -0.277   0.327
## 3     1 A     3      90.9 -1.18 -0.277   0.327
## 4     1 B     1     101.  -1.18 -0.277   0.327
## 5     1 B     2     108.  -1.18 -0.277   0.327
## 6     1 B     3      93.4 -1.18 -0.277   0.327
```

---

# Dplyr


```r
dat %&gt;% 
  pivot_wider(names_from = c(cond1, cond2), values_from = value) %&gt;% 
  select(id, starts_with("A")) %&gt;% 
  head()
```

```
## # A tibble: 6 x 4
##      id   A_1   A_2   A_3
##   &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     1  98.3 100.   90.9
## 2     2 110.   91.0 103. 
## 3     3 102.   83.4 106. 
## 4     4  92.0  88.0 104. 
## 5     5  87.3 103.   96.3
## 6     6 102.   94.0 111.
```

---

# Dplyr


```r
dat %&gt;% 
  filter(cond1 == "A" &amp; cond2 == 2) %&gt;% 
  head()
```

```
## # A tibble: 6 x 6
##      id cond1 cond2 value   cov1    cov2
##   &lt;int&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;
## 1     1 A     2     100.  -1.18  -0.277 
## 2     2 A     2      91.0  0.294  0.252 
## 3     3 A     2      83.4 -1.03   0.0898
## 4     4 A     2      88.0 -0.648  1.39  
## 5     5 A     2     103.   0.180  0.275 
## 6     6 A     2      94.0 -0.358 -0.0788
```

---

# Dplyr


```r
dat %&gt;% 
  group_by(cond1, cond2) %&gt;% 
  summarise(mean = mean(value),
            sd = sd(value)) %&gt;% 
  arrange(cond1)
```

```
## `summarise()` regrouping output by 'cond1' (override with `.groups` argument)
```

```
## # A tibble: 9 x 4
## # Groups:   cond1 [3]
##   cond1 cond2  mean    sd
##   &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 A     1      98.1 10.2 
## 2 A     2      95.3  6.36
## 3 A     3     106.   7.93
## 4 B     1     101.   9.49
## 5 B     2      96.0 12.6 
## 6 B     3     100.   6.78
## 7 C     1     105.  13.5 
## 8 C     2     102.  11.7 
## 9 C     3     101.   9.93
```

---

# GGplot2

.pull-left[
&lt;img src="img/ggplot2.svg" width="300" style="display: block; margin: auto;" /&gt;
]

.pull-right[

* Easy to integrate with workflow and pipelines

* Lack of `%&gt;%` functions &lt;sup&gt;3&lt;/sup&gt;

* Amazing way to combine different layers of plot components

]

.footnote[[3] Hadley Wickam [talk](https://www.youtube.com/watch?v=vYwXMnC03I4&amp;t=2203s) about "mistakes" in developing the tidyverse
]

---

# GGplot2


```r
dat %&gt;% 
  select(cov1, cov2) %&gt;% 
  ggplot(aes(x = cov1, y = cov2)) +
  geom_point()
```

&lt;img src="tidyverse_presentation_files/figure-html/unnamed-chunk-34-1.png" height="400" style="display: block; margin: auto;" /&gt;

---

# Broom

.pull-left[
&lt;img src="img/broom.svg" width="300" style="display: block; margin: auto;" /&gt;
]

.pull-right[

* Manipulate **fitted models** and return **tidy data**

* Very useful for extracting information from multiple models in a easy way

* There are some expansions like `broom mixed` for `lme4` objects

]

---

# Broom


```r
fit &lt;- lm(value ~ cond1 * cond2 + cov1 + cov2, data = dat)
tidy(fit) %&gt;%  head()
```

```
## # A tibble: 6 x 5
##   term        estimate std.error statistic  p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)    98.2       3.18    30.9   7.14e-46
## 2 cond1B          2.74      4.49     0.609 5.44e- 1
## 3 cond1C          6.93      4.49     1.54  1.27e- 1
## 4 cond22         -2.82      4.49    -0.628 5.32e- 1
## 5 cond23          7.57      4.49     1.68  9.61e- 2
## 6 cov1            1.14      1.13     1.01  3.18e- 1
```

```r
glance(fit)
```

```
## # A tibble: 1 x 12
##   r.squared adj.r.squared sigma statistic p.value    df logLik   AIC   BIC
##       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     0.142        0.0339  10.0      1.31   0.238    10  -330.  683.  713.
## # ... with 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;
```

---

# Other packages

.pull-left[

### String manipulation

&lt;img src="img/stringr.svg" width="250" style="display: block; margin: auto;" /&gt;
]

.pull-right[

### Work with dates

&lt;img src="img/lubridate.svg" width="250" style="display: block; margin: auto;" /&gt;
]

---

# Other packages

.pull-left[

### Datatable power, dyplr code

&lt;img src="img/dtplyr.svg" width="500" style="display: block; margin: auto;" /&gt;
]

.pull-right[

### Modelling (e.g., broom)

&lt;img src="img/tidymodels.svg" width="250" style="display: block; margin: auto;" /&gt;
]

---

# Other packages

.pull-left[

### Tidybayes

&lt;img src="img/tidybayes.png" width="400" style="display: block; margin: auto;" /&gt;
]

.pull-right[

* Some **geoms** for `ggplo2` and function to manage fitted **bayesian models**

* Support `rstanarm`, `brms`

&lt;img src="img/tidybayes_plot.png" width="600" style="display: block; margin: auto;" /&gt;

]

---

# Some Resources

## R4DS - R for Data Science

.pull-left[
&lt;img src="img/r4ds.jpg" width="200" style="display: block; margin: auto;" /&gt;
]

.pull-right[

* Best book for the **tidy** approach the **data science** in general

&lt;/br&gt;

* Especially the [many models](https://r4ds.had.co.nz/many-models.html) chapter

]

.footnote[[R4DS Book](https://r4ds.had.co.nz/)]

---

# Talks

* [David Robinson - Ten Tremendous Tricks in the Tidyverse](https://www.youtube.com/watch?v=NDHSBUN_rVU)

* [David Robinson - Teach the Tidyverse to Beginners](https://www.youtube.com/watch?v=dT5A0sAWc2I)

* [Hadley Wickham - Managing many models with R](https://www.youtube.com/watch?v=rz3_FDVt9eg&amp;t)

* [Hadley Wickham - Mistakes of the Tidyverse](https://www.youtube.com/watch?v=vYwXMnC03I4&amp;t)

* [Hadley Wickham - Data visualization and data science](https://www.youtube.com/watch?v=9YTNYT1maa4&amp;t)

* [Emily Robinson - The lesser known stars of the Tidyverse](https://www.youtube.com/watch?v=ax4LXQ5t38k)

---

class: inverse, center, middle

&lt;br/&gt;
&lt;br/&gt;

### .large[[filippo.gambarota@phd.unipd.it](mailto:filippo.gambarota@phd.unipd.it)]

&lt;br/&gt;
&lt;br/&gt;

.tiny[Slides made with the [Xaringan](https://github.com/yihui/xaringan) package by [Yihui Xie](https://yihui.name/)]


&lt;img src="img/final_logo.svg" width="450" style="display: block; margin: auto;" /&gt;
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
